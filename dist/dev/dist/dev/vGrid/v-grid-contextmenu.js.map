{"version":3,"sources":["vGrid/v-grid-contextmenu.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;6BAOa,W;AAEX,6BAAY,OAAZ,EAAqB,KAArB,EAA4B;AAAA;;AAC1B,eAAK,OAAL,GAAe,OAAf;AACA,eAAK,KAAL,GAAa,KAAb;;AAGA,eAAK,oBAAL,GAA4B,qBAA5B;AACA,eAAK,wBAAL,GAAgC,2BAAhC;AACA,eAAK,wBAAL,GAAgC,2BAAhC;AACA,eAAK,yBAAL,GAAiC,4BAAjC;;AAGA,eAAK,iBAAL,GAAyB,IAAzB;;AAEA,eAAK,WAAL,GAAmB,IAAnB;AACA,eAAK,YAAL,GAAoB,IAApB;AACA,eAAK,YAAL,GAAoB,IAApB;;AAGA,eAAK,SAAL,GAAiB,CAAjB;AACA,eAAK,SAAL,GAAiB,IAAjB;AACA,eAAK,UAAL,GAAkB,IAAlB;AACA,eAAK,YAAL,GAAoB,IAApB;AACA,eAAK,aAAL,GAAqB,IAArB;AACA,eAAK,aAAL,GAAqB,IAArB;;AAEA,eAAK,WAAL,GAAmB,IAAnB;AACA,eAAK,YAAL,GAAoB,IAApB;AAGD;;8BAGD,O,oBAAQ,K,EAAO;AACb,iBAAO,KAAK,KAAL,CAAW,WAAX,CAAuB,WAAvB,CAAmC,KAAnC,CAAP;AACD,S;;8BAGD,I,iBAAK,c,EAAgB,e,EAAiB;AACpC,eAAK,cAAL,GAAsB,cAAtB;AACA,eAAK,eAAL,GAAuB,eAAvB;AACD,S;;8BAGD,Q,uBAAW;AACT,eAAK,OAAL,CAAa,SAAb,CAAuB,QAAvB,CAAgC,KAAK,aAArC,IAAsD,IAAtD,GAA6D,KAAK,OAAL,CAAa,SAAb,CAAuB,GAAvB,CAA2B,KAAK,aAAhC,CAA7D;AACA,eAAK,WAAL;AACD,S;;8BAGD,Q,uBAAW;AACT,eAAK,cAAL;AACD,S;;8BAGD,O,sBAAU;AACR,iBAAO,IAAP;AACD,S;;8BAGD,W,0BAAc;AACZ,cAAI,KAAK,SAAT,EAAoB;AAClB,iBAAK,aAAL;AACD;AACF,S;;8BAGD,W,0BAAc;AACZ,eAAK,qBAAL,GAA6B,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAA7B;AACA,eAAK,iBAAL,GAAyB,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAAzB;AACA,eAAK,OAAL,CAAa,gBAAb,CAA8B,aAA9B,EAA6C,KAAK,qBAAlD;AACA,eAAK,KAAL,CAAW,OAAX,CAAmB,gBAAnB,CAAoC,6BAApC,EAAmE,KAAK,iBAAxE;AACD,S;;8BAGD,c,6BAAiB;AACf,eAAK,OAAL,CAAa,mBAAb,CAAiC,aAAjC,EAAgD,KAAK,qBAArD;AACA,eAAK,OAAL,CAAa,mBAAb,CAAiC,6BAAjC,EAAgE,KAAK,iBAArE;AAED,S;;8BAGD,e,4BAAgB,C,EAAG;AAGjB,cAAI,QAAQ,IAAI,WAAJ,CAAgB,6BAAhB,EAA+C;AACzD,oBAAQ,EADiD;AAEzD,qBAAS;AAFgD,WAA/C,CAAZ;AAIA,eAAK,KAAL,CAAW,OAAX,CAAmB,aAAnB,CAAiC,KAAjC;;AAGA,cAAI,KAAK,OAAL,CAAa,CAAb,CAAJ,EAAqB;;AAEnB,iBAAK,iBAAL,GAAyB,KAAK,kBAAL,CAAwB,CAAxB,EAA2B,KAAK,aAAhC,CAAzB;;AAEA,gBAAI,KAAK,iBAAT,EAA4B;AAC1B,gBAAE,cAAF;AACA,mBAAK,YAAL;AACA,mBAAK,YAAL,CAAkB,CAAlB;AACD,aAJD,MAIO;AACL,mBAAK,iBAAL,GAAyB,IAAzB;AACA,mBAAK,aAAL;AACD;AAEF,WAbD,MAaO;AACL,iBAAK,aAAL;AACD;AACF,S;;8BAGD,mB,kCAAsB;AACpB,eAAK,mBAAL,GAA2B,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAA3B;AACA,mBAAS,gBAAT,CAA0B,OAA1B,EAAmC,KAAK,mBAAxC;AACD,S;;8BAGD,sB,qCAAyB;AACvB,mBAAS,mBAAT,CAA6B,OAA7B,EAAsC,KAAK,mBAA3C;AACD,S;;8BAGD,a,0BAAc,C,EAAG;AACf,cAAI,iBAAiB,KAAK,kBAAL,CAAwB,CAAxB,EAA2B,KAAK,wBAAhC,CAArB;;AAEA,cAAI,kBAAkB,KAAK,iBAA3B,EAA8C;AAC5C,cAAE,cAAF;AACA,iBAAK,gBAAL,CAAsB,cAAtB;AACD,WAHD,MAGO;AACL,gBAAI,SAAS,EAAE,KAAF,IAAW,EAAE,MAA1B;AACA,gBAAI,WAAW,CAAf,EAAkB;AAChB,mBAAK,aAAL;AACD;AACF;AAEF,S;;8BAGD,kB,+BAAmB,C,EAAG,S,EAAW;AAC/B,cAAI,KAAK,EAAE,UAAF,IAAgB,EAAE,MAA3B;;AAEA,cAAI,GAAG,SAAH,CAAa,QAAb,CAAsB,SAAtB,CAAJ,EAAsC;AACpC,mBAAO,EAAP;AACD,WAFD,MAEO;AACL,mBAAO,OAAO,GAAG,UAAjB,EAA6B;AAC3B,kBAAI,GAAG,SAAH,IAAgB,GAAG,SAAH,CAAa,QAAb,CAAsB,SAAtB,CAApB,EAAsD;AACpD,uBAAO,EAAP;AACD;AACF;AACF;;AAED,iBAAO,KAAP;AACD,S;;8BAGD,U,yBAAa;AACX,eAAK,IAAL,GAAY,SAAS,aAAT,CAAuB,KAAvB,CAAZ;AACA,eAAK,IAAL,CAAU,SAAV,CAAoB,GAApB,CAAwB,KAAK,oBAA7B;AACA,eAAK,IAAL,CAAU,SAAV,GAAsB,KAAK,YAAL,EAAtB;AACA,mBAAS,IAAT,CAAc,WAAd,CAA0B,KAAK,IAA/B;AACA,eAAK,SAAL,GAAiB,KAAK,IAAL,CAAU,gBAAV,CAA2B,MAAM,KAAK,wBAAtC,CAAjB;AACD,S;;8BAGD,W,wBAAY,I,EAAM;AAChB,eAAK,IAAL,CAAU,SAAV,GAAsB,IAAtB;AACA,eAAK,SAAL,GAAiB,KAAK,IAAL,CAAU,gBAAV,CAA2B,MAAM,KAAK,wBAAtC,CAAjB;AACD,S;;8BAGD,U,yBAAa;AACX,mBAAS,IAAT,CAAc,WAAd,CAA0B,KAAK,IAA/B;AACA,eAAK,IAAL,GAAY,IAAZ;AACA,eAAK,SAAL,GAAiB,IAAjB;AACD,S;;8BAGD,Y,2BAAe;AACb,cAAI,KAAK,SAAL,KAAmB,CAAvB,EAA0B;AACxB,iBAAK,SAAL,GAAiB,CAAjB;AACA,iBAAK,UAAL;AACA,iBAAK,mBAAL;AACD;AACF,S;;8BAGD,a,4BAAgB;AACd,cAAI,KAAK,SAAL,KAAmB,CAAvB,EAA0B;AACxB,iBAAK,SAAL,GAAiB,CAAjB;AACA,iBAAK,sBAAL;AACA,iBAAK,UAAL;AAED;AACF,S;;8BAMD,Y,yBAAa,C,EAAG;AACd,eAAK,WAAL,GAAmB,KAAK,WAAL,CAAiB,CAAjB,CAAnB;AACA,eAAK,YAAL,GAAoB,KAAK,WAAL,CAAiB,CAArC;AACA,eAAK,YAAL,GAAoB,KAAK,WAAL,CAAiB,CAArC;;AAEA,eAAK,SAAL,GAAiB,KAAK,IAAL,CAAU,WAAV,GAAwB,CAAzC;AACA,eAAK,UAAL,GAAkB,KAAK,IAAL,CAAU,YAAV,GAAyB,CAA3C;;AAEA,eAAK,WAAL,GAAmB,OAAO,UAA1B;AACA,eAAK,YAAL,GAAoB,OAAO,WAA3B;;AAEA,cAAK,KAAK,WAAL,GAAmB,KAAK,YAAzB,GAAyC,KAAK,SAAlD,EAA6D;AAC3D,iBAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,GAAuB,KAAK,WAAL,GAAmB,KAAK,SAAxB,GAAoC,IAA3D;AACD,WAFD,MAEO;AACL,iBAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,GAAuB,KAAK,YAAL,GAAoB,IAA3C;AACD;;AAED,cAAK,KAAK,YAAL,GAAoB,KAAK,YAA1B,GAA0C,KAAK,UAAnD,EAA+D;AAC7D,iBAAK,IAAL,CAAU,KAAV,CAAgB,GAAhB,GAAsB,KAAK,YAAL,GAAoB,KAAK,UAAzB,GAAsC,IAA5D;AACD,WAFD,MAEO;AACL,iBAAK,IAAL,CAAU,KAAV,CAAgB,GAAhB,GAAsB,KAAK,YAAL,GAAoB,IAA1C;AACD;AACF,S;;8BAMD,W,wBAAY,C,EAAG;AACb,cAAI,OAAO,CAAX;AACA,cAAI,OAAO,CAAX;;AAEA,cAAI,CAAC,CAAL,EAAQ,IAAI,IAAI,OAAO,KAAf;;AAER,cAAI,EAAE,KAAF,IAAW,EAAE,KAAjB,EAAwB;AACtB,mBAAO,EAAE,KAAT;AACA,mBAAO,EAAE,KAAT;AACD,WAHD,MAGO,IAAI,EAAE,OAAF,IAAa,EAAE,OAAnB,EAA4B;AACjC,mBAAO,EAAE,OAAF,GAAY,SAAS,IAAT,CAAc,UAA1B,GAAuC,SAAS,eAAT,CAAyB,UAAvE;AACA,mBAAO,EAAE,OAAF,GAAY,SAAS,IAAT,CAAc,SAA1B,GAAsC,SAAS,eAAT,CAAyB,SAAtE;AACD;;AAED,iBAAO;AACL,eAAG,IADE;AAEL,eAAG;AAFE,WAAP;AAID,S;;8BAGD,c,2BAAe,S,EAAW;AAAA;;AAExB,cAAI,WAAW,SAAS,aAAT,CAAuB,IAAvB,CAAf;;AAEA,oBAAU,OAAV,CAAkB,UAAC,GAAD,EAAQ;AACxB,gBAAI,KAAK,SAAS,aAAT,CAAuB,IAAvB,CAAT;AACA,eAAG,SAAH,CAAa,GAAb,CAAiB,MAAK,wBAAtB;AACA,gBAAI,IAAI,SAAS,aAAT,CAAuB,GAAvB,CAAR;AACA,gBAAI,IAAI,QAAR,EAAkB;AAChB,gBAAE,SAAF,CAAY,GAAZ,CAAgB,MAAK,yBAArB;AACD,aAFD,MAEO;AACL,gBAAE,SAAF,CAAY,GAAZ,CAAgB,MAAK,wBAArB;AACD;AACD,cAAE,YAAF,CAAe,aAAf,EAA8B,IAAI,MAAlC;AACA,cAAE,SAAF,GAAc,IAAI,KAAlB;AACA,qBAAS,WAAT,CAAqB,CAArB;AACD,WAZD;;AAcA,iBAAO,SAAS,SAAhB;AAED,S","file":"vGrid/v-grid-contextmenu.js","sourceRoot":"/source/","sourcesContent":["/*****************************************************************************************************************\n *    Contextmenu\n *    Main class for attributes \"context menu\"\n *    Created by vegar ringdal\n *\n ****************************************************************************************************************/\n\nexport class Contextmenu {\n\n  constructor(element, vGrid) {\n    this.element = element;\n    this.vGrid = vGrid;\n\n    //main classes, should I just add these to the v-grid-config?\n    this.contextMenuClassName = \"v-grid-context-menu\";\n    this.contextMenuItemClassName = \"v-grid-context-menu__item\";\n    this.contextMenuLinkClassName = \"v-grid-context-menu__link\";\n    this.contextMenuSplitClassName = \"v-grid-context-menu__split\";\n\n\n    this.taskItemInContext = null;\n\n    this.clickCoords = null;\n    this.clickCoordsX = null;\n    this.clickCoordsY = null;\n\n\n    this.menuState = 0;\n    this.menuWidth = null;\n    this.menuHeight = null;\n    this.menuPosition = null;\n    this.menuPositionX = null;\n    this.menuPositionY = null;\n\n    this.windowWidth = null;\n    this.windowHeight = null;\n\n\n  }\n\n\n  getLang(value) {\n    return this.vGrid.vGridConfig.attLanguage[value];\n  }\n\n\n  bind(bindingContext, overrideContext) {\n    this.bindingContext = bindingContext;\n    this.overrideContext = overrideContext;\n  }\n\n\n  attached() {\n    this.element.classList.contains(this.classToOpenOn) ? null : this.element.classList.add(this.classToOpenOn);\n    this.addListener();\n  }\n\n\n  detached() {\n    this.removeListener();\n  }\n\n\n  canOpen() {\n    return true;\n  }\n\n\n  closeIfOpen() {\n    if (this.menuState) {\n      this.toggleMenuOff();\n    }\n  }\n\n\n  addListener() {\n    this.contextListenerBinded = this.contextListener.bind(this);\n    this.closeIfOpenBinded = this.closeIfOpen.bind(this);\n    this.element.addEventListener(\"contextmenu\", this.contextListenerBinded);\n    this.vGrid.element.addEventListener(\"vGridCloseContextMenuIfOpen\", this.closeIfOpenBinded);\n  }\n\n\n  removeListener() {\n    this.element.removeEventListener(\"contextmenu\", this.contextListenerBinded);\n    this.element.removeEventListener(\"vGridCloseContextMenuIfOpen\", this.closeIfOpenBinded);\n\n  }\n\n\n  contextListener(e) {\n\n    //close if menus if they are open when opening a new one\n    let event = new CustomEvent(\"vGridCloseContextMenuIfOpen\", {\n      detail: \"\",\n      bubbles: true\n    });\n    this.vGrid.element.dispatchEvent(event);\n\n\n    if (this.canOpen(e)) {\n\n      this.taskItemInContext = this.clickInsideElement(e, this.classToOpenOn);\n\n      if (this.taskItemInContext) {\n        e.preventDefault();\n        this.toggleMenuOn();\n        this.positionMenu(e);\n      } else {\n        this.taskItemInContext = null;\n        this.toggleMenuOff();\n      }\n\n    } else {\n      this.toggleMenuOff();\n    }\n  }\n\n\n  addMenuClickListner() {\n    this.clickListenerBinded = this.clickListener.bind(this);\n    document.addEventListener(\"click\", this.clickListenerBinded);\n  }\n\n\n  removeMenuClickListner() {\n    document.removeEventListener(\"click\", this.clickListenerBinded);\n  }\n\n\n  clickListener(e) {\n    var clickeElIsLink = this.clickInsideElement(e, this.contextMenuLinkClassName);\n\n    if (clickeElIsLink && this.taskItemInContext) {\n      e.preventDefault();\n      this.menuItemListener(clickeElIsLink);\n    } else {\n      var button = e.which || e.button;\n      if (button === 1) {\n        this.toggleMenuOff();\n      }\n    }\n\n  }\n\n\n  clickInsideElement(e, className) {\n    var el = e.srcElement || e.target;\n\n    if (el.classList.contains(className)) {\n      return el;\n    } else {\n      while (el === el.parentNode) {\n        if (el.classList && el.classList.contains(className)) {\n          return el;\n        }\n      }\n    }\n\n    return false;\n  }\n\n\n  createMenu() {\n    this.menu = document.createElement(\"nav\");\n    this.menu.classList.add(this.contextMenuClassName);\n    this.menu.innerHTML = this.menuHtmlMain();\n    document.body.appendChild(this.menu);\n    this.menuItems = this.menu.querySelectorAll(\".\" + this.contextMenuItemClassName);\n  }\n\n\n  replaceMenu(html) {\n    this.menu.innerHTML = html;\n    this.menuItems = this.menu.querySelectorAll(\".\" + this.contextMenuItemClassName);\n  }\n\n\n  removeMenu() {\n    document.body.removeChild(this.menu);\n    this.menu = null;\n    this.menuItems = null;\n  }\n\n\n  toggleMenuOn() {\n    if (this.menuState !== 1) {\n      this.menuState = 1;\n      this.createMenu();\n      this.addMenuClickListner();\n    }\n  }\n\n\n  toggleMenuOff() {\n    if (this.menuState !== 0) {\n      this.menuState = 0;\n      this.removeMenuClickListner();\n      this.removeMenu();\n\n    }\n  }\n\n\n  /**\n   * Positions the menu properly.\n   */\n  positionMenu(e) {\n    this.clickCoords = this.getPosition(e);\n    this.clickCoordsX = this.clickCoords.x;\n    this.clickCoordsY = this.clickCoords.y;\n\n    this.menuWidth = this.menu.offsetWidth + 4;\n    this.menuHeight = this.menu.offsetHeight + 4;\n\n    this.windowWidth = window.innerWidth;\n    this.windowHeight = window.innerHeight;\n\n    if ((this.windowWidth - this.clickCoordsX) < this.menuWidth) {\n      this.menu.style.left = this.windowWidth - this.menuWidth + \"px\";\n    } else {\n      this.menu.style.left = this.clickCoordsX + \"px\";\n    }\n\n    if ((this.windowHeight - this.clickCoordsY) < this.menuHeight) {\n      this.menu.style.top = this.windowHeight - this.menuHeight + \"px\";\n    } else {\n      this.menu.style.top = this.clickCoordsY + \"px\";\n    }\n  }\n\n\n  /**\n   * Get's exact position of event.\n   */\n  getPosition(e) {\n    var posx = 0;\n    var posy = 0;\n\n    if (!e) var e = window.event;\n\n    if (e.pageX || e.pageY) {\n      posx = e.pageX;\n      posy = e.pageY;\n    } else if (e.clientX || e.clientY) {\n      posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n      posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n\n    return {\n      x: posx,\n      y: posy\n    }\n  }\n\n\n  createMenuHTML(menuArray) {\n\n    var tempHtml = document.createElement(\"ul\");\n\n    menuArray.forEach((row)=> {\n      let li = document.createElement(\"li\");\n      li.classList.add(this.contextMenuItemClassName);\n      let a = document.createElement(\"a\");\n      if (row.isHeader) {\n        a.classList.add(this.contextMenuSplitClassName)\n      } else {\n        a.classList.add(this.contextMenuLinkClassName)\n      }\n      a.setAttribute(\"data-action\", row.action);\n      a.innerHTML = row.value;\n      tempHtml.appendChild(a);\n    });\n\n    return tempHtml.innerHTML;\n\n  }\n\n\n}\n"]}