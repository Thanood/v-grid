{"version":3,"sources":["vGrid/v-grid-contextmenu.js"],"names":[],"mappings":"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","file":"vGrid/v-grid-contextmenu.js","sourceRoot":"/source/","sourcesContent":["/*****************************************************************************************************************\r\n *    Contextmenu\r\n *    Main class for attributes \"context menu\"\r\n *    Created by vegar ringdal\r\n *\r\n ****************************************************************************************************************/\r\n\r\nexport class Contextmenu {\r\n\r\n  constructor(element, vGrid) {\r\n    this.element = element;\r\n    this.vGrid = vGrid;\r\n\r\n    //main classes, should I just add these to the v-grid-config?\r\n    this.contextMenuClassName = \"v-grid-context-menu\";\r\n    this.contextMenuItemClassName = \"v-grid-context-menu__item\";\r\n    this.contextMenuLinkClassName = \"v-grid-context-menu__link\";\r\n    this.contextMenuSplitClassName = \"v-grid-context-menu__split\";\r\n\r\n\r\n    this.taskItemInContext = null;\r\n\r\n    this.clickCoords = null;\r\n    this.clickCoordsX = null;\r\n    this.clickCoordsY = null;\r\n\r\n\r\n    this.menuState = 0;\r\n    this.menuWidth = null;\r\n    this.menuHeight = null;\r\n    this.menuPosition = null;\r\n    this.menuPositionX = null;\r\n    this.menuPositionY = null;\r\n\r\n    this.windowWidth = null;\r\n    this.windowHeight = null;\r\n\r\n\r\n  }\r\n\r\n\r\n  bind(bindingContext, overrideContext) {\r\n    this.bindingContext = bindingContext;\r\n    this.overrideContext = overrideContext;\r\n  }\r\n\r\n\r\n  attached() {\r\n      this.element.classList.contains(this.classToOpenOn)? null:this.element.classList.add(this.classToOpenOn);\r\n      this.addListener();\r\n  }\r\n\r\n\r\n  detached() {\r\n      this.removeListener();\r\n  }\r\n\r\n\r\n  canOpen() {\r\n    return true;\r\n  }\r\n\r\n\r\n  addListener() {\r\n    this.contextListenerBinded = this.contextListener.bind(this);\r\n    this.element.addEventListener(\"contextmenu\", this.contextListenerBinded);\r\n  }\r\n\r\n\r\n  removeListener() {\r\n    this.element.removeEventListener(\"contextmenu\", this.contextListenerBinded);\r\n  }\r\n\r\n\r\n  contextListener(e) {\r\n    if (this.canOpen(e)) {\r\n\r\n      this.taskItemInContext = this.clickInsideElement(e, this.classToOpenOn);\r\n\r\n      if (this.taskItemInContext) {\r\n        e.preventDefault();\r\n        this.toggleMenuOn();\r\n        this.positionMenu(e);\r\n      } else {\r\n        this.taskItemInContext = null;\r\n        this.toggleMenuOff();\r\n      }\r\n\r\n    } else {\r\n      this.toggleMenuOff();\r\n    }\r\n  }\r\n\r\n\r\n  addMenuClickListner() {\r\n    this.clickListenerBinded = this.clickListener.bind(this);\r\n    document.addEventListener(\"click\", this.clickListenerBinded);\r\n  }\r\n\r\n\r\n  removeMenuClickListner() {\r\n    document.removeEventListener(\"click\", this.clickListenerBinded);\r\n  }\r\n\r\n\r\n  clickListener(e) {\r\n    var clickeElIsLink = this.clickInsideElement(e, this.contextMenuLinkClassName);\r\n\r\n    if (clickeElIsLink && this.taskItemInContext) {\r\n      e.preventDefault();\r\n      this.menuItemListener(clickeElIsLink);\r\n    } else {\r\n      var button = e.which || e.button;\r\n      if (button === 1) {\r\n        this.toggleMenuOff();\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n\r\n  clickInsideElement(e, className) {\r\n    var el = e.srcElement || e.target;\r\n\r\n    if (el.classList.contains(className)) {\r\n      return el;\r\n    } else {\r\n      while (el = el.parentNode) {\r\n        if (el.classList && el.classList.contains(className)) {\r\n          return el;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n\r\n  createMenu() {\r\n    this.menu = document.createElement(\"nav\");\r\n    this.menu.classList.add(this.contextMenuClassName);\r\n    this.menu.innerHTML = this.menuHtmlMain();\r\n    document.body.appendChild(this.menu);\r\n    this.menuItems = this.menu.querySelectorAll(\".\" + this.contextMenuItemClassName);\r\n  }\r\n\r\n\r\n  replaceMenu(html) {\r\n    this.menu.innerHTML = html;\r\n    this.menuItems = this.menu.querySelectorAll(\".\" + this.contextMenuItemClassName);\r\n  }\r\n\r\n\r\n  removeMenu() {\r\n    document.body.removeChild(this.menu);\r\n    this.menu = null;\r\n    this.menuItems = null;\r\n  }\r\n\r\n\r\n  toggleMenuOn() {\r\n    if (this.menuState !== 1) {\r\n      this.menuState = 1;\r\n      this.createMenu();\r\n      this.addMenuClickListner();\r\n    }\r\n  }\r\n\r\n\r\n  toggleMenuOff() {\r\n    if (this.menuState !== 0) {\r\n      this.menuState = 0;\r\n      this.removeMenuClickListner();\r\n      this.removeMenu();\r\n\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Positions the menu properly.\r\n   */\r\n  positionMenu(e) {\r\n    this.clickCoords = this.getPosition(e);\r\n    this.clickCoordsX = this.clickCoords.x;\r\n    this.clickCoordsY = this.clickCoords.y;\r\n\r\n    this.menuWidth = this.menu.offsetWidth + 4;\r\n    this.menuHeight = this.menu.offsetHeight + 4;\r\n\r\n    this.windowWidth = window.innerWidth;\r\n    this.windowHeight = window.innerHeight;\r\n\r\n    if ((this.windowWidth - this.clickCoordsX) < this.menuWidth) {\r\n      this.menu.style.left = this.windowWidth - this.menuWidth + \"px\";\r\n    } else {\r\n      this.menu.style.left = this.clickCoordsX + \"px\";\r\n    }\r\n\r\n    if ((this.windowHeight - this.clickCoordsY) < this.menuHeight) {\r\n      this.menu.style.top = this.windowHeight - this.menuHeight + \"px\";\r\n    } else {\r\n      this.menu.style.top = this.clickCoordsY + \"px\";\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Get's exact position of event.\r\n   */\r\n  getPosition(e) {\r\n    var posx = 0;\r\n    var posy = 0;\r\n\r\n    if (!e) var e = window.event;\r\n\r\n    if (e.pageX || e.pageY) {\r\n      posx = e.pageX;\r\n      posy = e.pageY;\r\n    } else if (e.clientX || e.clientY) {\r\n      posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n      posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n    }\r\n\r\n    return {\r\n      x: posx,\r\n      y: posy\r\n    }\r\n  }\r\n\r\n\r\n  createMenuHTML(menuArray) {\r\n\r\n    var tempHtml = document.createElement(\"ul\");\r\n\r\n    menuArray.forEach((row)=> {\r\n      let li = document.createElement(\"li\");\r\n      li.classList.add(this.contextMenuItemClassName);\r\n      let a = document.createElement(\"a\");\r\n      if (row.isHeader) {\r\n        a.classList.add(this.contextMenuSplitClassName)\r\n      } else {\r\n        a.classList.add(this.contextMenuLinkClassName)\r\n      }\r\n      a.setAttribute(\"data-action\", row.action);\r\n      a.innerHTML = row.value;\r\n      tempHtml.appendChild(a);\r\n    });\r\n\r\n    return tempHtml.innerHTML;\r\n\r\n  }\r\n\r\n\r\n}\r\n"]}