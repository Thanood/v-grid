{"version":3,"sources":["vGrid/v-grid-attributes-resize-col.js"],"names":[],"mappings":"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","file":"vGrid/v-grid-attributes-resize-col.js","sourceRoot":"/source/","sourcesContent":["/*****************************************************************************************************************\n *    Adds resizing to the columns\n *    Can not be used with row repeat... not atleast yet..\n *    Created by vegar ringdal\n *\n ****************************************************************************************************************/\nimport {inject, customAttribute} from 'aurelia-framework';\nimport {VGrid} from './v-grid';\n\n\n@customAttribute('v-resize-col')\n@inject(Element, VGrid)\nexport class vGridAttributesResizeCol {\n\n\n  constructor(element, vGrid) {\n    this.vGrid = vGrid;\n    this.vGridConfig = this.vGrid.vGridConfig;\n    this.vGridGenerator = this.vGrid.vGridGenerator;\n    this.element = element;\n    this.resizable = false;\n    this.screenX;\n    this.index;\n    this.originalWidth;\n\n  }\n\n\n  bind(bindingContext, overrideContext) {\n    this.bindingContext = bindingContext;\n    this.overrideContext = overrideContext;\n\n  }\n\n\n  attached() {\n\n    //get the column element\n    let mainCol = this.element;\n    while (mainCol.nodeName !== 'V-GRID-HEADER-COL') {\n      mainCol = mainCol.parentNode;\n    }\n    this.mainCol = mainCol;\n\n    //add resize handle\n    var resizeHandle = document.createElement(\"DIV\");\n    resizeHandle.classList.add(this.vGridConfig.css.resizeHeaderDragHandle);\n\n    //register onmouse doen event\n    resizeHandle.onmousedown = (e) => {\n      this.onmousedown(e);\n    };\n\n    //add\n    this.mainCol.appendChild(resizeHandle);\n\n  }\n\n  /**************************************************\n   *  when mouse button is let go\n   **************************************************/\n  onmouseup() {\n\n    //set state\n    this.resizable = true;\n\n    //remove events\n    this.vGridGenerator.headerElement.onmouseleave = \"\";\n    this.vGridGenerator.headerElement.onmousemove = \"\";\n    this.vGridGenerator.headerElement.onmouseup = \"\";\n\n    //update this column width\n    this.vGridConfig.colConfig[this.index].colWidth = parseInt(this.mainCol.style.width);\n\n    //reset template and fill data\n    this.vGridGenerator.rowTemplate = null;\n    this.vGridGenerator.correctRowAndScrollbodyWidth();\n    this.vGridGenerator.recreateRowViewSlots();\n    this.vGridGenerator.updateGridScrollbars();\n    this.vGridGenerator.rebindAllRowSlots(true);\n\n  }\n\n\n  /**************************************************\n   *  when mouse moving mouse\n   **************************************************/\n  onmousemove(e) {\n\n    //get when user let go of mouse button\n    this.vGridGenerator.headerElement.onmouseup = () => {\n      this.onmouseup();\n    };\n\n    //if mouse leaves header we want to stop, else it just gets buggy\n    this.vGridGenerator.headerElement.onmouseleave = (e) => {\n      this.vGridGenerator.headerElement.onmouseup(e);\n    };\n\n    //update\n    if (this.resizable) {\n      this.updateHeader(e);\n    } else {\n      this.vGridGenerator.correctHeaderAndScrollbodyWidth();\n    }\n  }\n\n\n  /**************************************************\n   *  updates the actual header/row column width\n   **************************************************/\n  updateHeader(e) {\n\n    //updates\n    var newWidth = parseInt(this.originalWidth) - ((this.screenX - e.screenX)) + \"px\";\n    if (parseInt(newWidth) > 15) {\n      this.vGridConfig.colConfig[this.index].colWidth = parseInt(newWidth);\n      this.mainCol.style.width = parseInt(this.originalWidth) - ((this.screenX - e.screenX)) + \"px\";\n      this.mainCol.style.width = parseInt(this.originalWidth) - ((this.screenX - e.screenX)) + \"px\";\n\n      //if resize also row attribute is set to true, then we also need to update them\n      if (this.vGridConfig.attResizableHeadersAndRows) {\n\n        //get the columns of the row\n        var columnsToFix = this.vGridGenerator.contentElement.firstChild.querySelectorAll(\".\" + this.vGridConfig.css.rowColumn + this.index);\n\n        //loop the columns and update each row\n        for (var col = 0; col < columnsToFix.length; col++) {\n          columnsToFix[col].style.width = newWidth;\n        }\n\n        //update scrollbars and row widths\n        this.vGridGenerator.correctRowAndScrollbodyWidth();\n        this.vGridGenerator.updateGridScrollbars();\n\n      }\n    }\n\n  }\n\n\n  /**************************************************\n   *  when mouse down, resizing starts\n   **************************************************/\n  onmousedown(e) {\n    //set state\n    this.resizable = true;\n\n    //get som vars\n    this.screenX = e.screenX;\n    this.originalWidth = this.mainCol.style.width;\n    this.index = this.mainCol.getAttribute(\"column-no\");\n    this.started = false;\n\n\n    //add mouse move event\n    this.vGridGenerator.headerElement.onmousemove = (e) => {\n      this.started = true;\n      this.onmousemove(e);\n    };\n\n\n    //incase they just release right away\n    this.vGridGenerator.headerElement.onmouseup = () => {\n      if (!this.started) {\n        this.vGridGenerator.headerElement.onmousemove = \"\";\n      }\n    };\n\n  }\n\n\n}\n"]}